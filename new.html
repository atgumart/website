<!DOCTYPE html>
<html lang="pt-BR">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>Gumart Imóveis</title>
        <link rel="icon" type="image/png" href="/assets/favicon.png">
        <link href="/assets/css/bootstrap.css" rel="stylesheet">
        <link href="/assets/css/fonts.css" rel="stylesheet">
    </head>
    <body>
        <div class="container-md my-3">
            <h1 class="text-center display-3 my-5"><a class="text-decoration-none link-dark" href="/">Gumart Imóveis</a></h1>
            <div class="row g-3 justify-content-center align-items-center">
                <div class="col-6">
                    <label for="districtInput" class="form-label">Bairro</label>
                    <input type="text" class="form-control" id="districtInput">
                </div>
                <div class="col-6">
                    <label for="priceInput" class="form-label">Valor</label>
                    <input type="text" class="form-control" id="priceInput">
                </div>
                <div class="col-3">
                    <label for="bedroomsInput" class="form-label">Quartos</label>
                    <input type="text" class="form-control" id="bedroomsInput">
                </div>
                <div class="col-3">
                    <label for="bathroomsInput" class="form-label">Banheiros</label>
                    <input type="text" class="form-control" id="bathroomsInput">
                </div>
                <div class="col-3">
                    <label for="spotsInput" class="form-label">Vagas</label>
                    <input type="text" class="form-control" id="spotsInput">
                </div>
                <div class="col-3">
                    <label for="areaInput" class="form-label">Área (m²)</label>
                    <input type="text" class="form-control" id="areaInput">
                </div>
                <div class="col-12">
                    <label for="descriptionText" class="form-label">Descrição</label>
                    <textarea class="form-control" id="descriptionText" rows="3"></textarea>
                </div>
                <div class="col-6">
                    <label for="thumbnailInput" class="form-label">Thumbnail</label>
                    <input type="file" class="form-control" id="thumbnailInput">
                </div>
                <div class="col-6">
                    <label for="picsInput" class="form-label">Fotos</label>
                    <input type="file" class="form-control" id="picsInput" multiple>
                </div>
                <div class="col-6">
                    <button class="btn btn-outline-primary w-100" onclick="download('rent')">Alugar</button>
                </div>
                <div class="col-6">
                    <button class="btn btn-outline-primary w-100" onclick="download('sell')">Vender</button>
                </div>
            </div>
        </div>
        <script src="/assets/js/jszip.js"></script>
        <script src="/assets/js/FileSaver.js"></script>
        <script>
            function download(type) {
                const basedir = "id"
                const zip = new JSZip()
                const id = Date.now().toString(16)
                zip.file(`${basedir}/${id}.json`, JSON.stringify({
                    id: id,
                    district: districtInput.value,
                    type: type,
                    price: parseInt(priceInput.value),
                    bedrooms: parseInt(bedroomsInput.value),
                    bathrooms: parseInt(bathroomsInput.value),
                    spots: parseInt(spotsInput.value),
                    area: parseInt(areaInput.value),
                    description: descriptionText.value,
                    pics: picsInput.files.length
                }))
                zip.file(`${basedir}/${id}/thumbnail.jpg`, thumbnailInput.files[0], { base64: true })
                for (let i = 0; i < picsInput.files.length; i++) {
                    zip.file(`${basedir}/${id}/${i + 1}.jpg`, picsInput.files[i], { base64: true })
                }
                zip.generateAsync({ type: "blob" }).then(content => {
                    saveAs(content, `${id}.zip`)
                })
            }
        </script>
    </body>
</html>
